<!--
  ~ Copyright 2017-2019 Crown Copyright
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<div layout="row" layout-padding>
    <div flex-offset-gt-sm="20" flex-gt-sm="60" flex="100">
        <div layout="column" flex>
            <h3 class="md-headline">Settings</h3>
            <p>{{ ctrl.getCacheTtlMessage() }}</p>
            <section>
                <md-subheader class="md-no-sticky">Queries</md-subheader>
                <md-card>
                    <form name="ctrl.querySettingsForm">
                        <md-list>
                            <md-list-item class="md-2-line">
                                <div class="md-list-item-text" flex="60">
                                    <h3>Result count limit</h3>
                                    <p>The maximum number of results that can be returned</p>
                                </div>
                                <div flex></div>
                                <md-input-container class="md-secondary">
                                    <input type="number" min="0" max="2147483647" name="resultLimit" required step="1" ng-model="ctrl.resultLimit"
                                            id="resultLimit" aria-label="result count limit" ng-blur="ctrl.updateResultLimit()">
                                    <div ng-messages="ctrl.querySettingsForm.resultLimit.$error">
                                        <div ng-message="required">You must set a limit</div>
                                        <div ng-message="min">The limit must be a positive number</div>
                                        <div ng-message="max">The limit must be less than Integer.MAX_VALUE</div>
                                        <div ng-message="step">The limit must be a whole number</div>
                                        <div ng-message="number">The limit must be a valid number</div>
                                    </div>
                                </md-input-container>
                            </md-list-item>
                            <md-list-item class="md-2-line">
                                <div class="md-list-item-text" flex="60">
                                    <h3>Clear Operation Chain</h3>
                                    <p>Clear the operation chain after each execution</p>
                                </div>
                                <div flex></div>
                                <md-input-container class="md-secondary">
                                    <md-checkbox ng-change="ctrl.saveClearChainAfterExecution()" ng-model="ctrl.clearChainAfterExecution"></md-checkbox>
                                </md-input-container>
                            </md-list-item>
                        </md-list>
                    </form>
                </md-card>
            </section>
            
            <options master="true"></options>

            <md-subheader class="md-no-sticky">Schema</md-subheader>
            <md-card>
                <md-list class="no-vertical-padding">
                    <md-list-item class="md-2-line" ng-click="ctrl.updateSchema()">
                        <div class="md-list-item-text">
                            <h3>Reload schema</h3>
                            <p>Reloads the schema using the default operation options</p>
                        </div>
                        <span flex></span>
                        <md-button class="md-primary md-raised md-secondary"
                            aria-label="reload schema"
                            ng-click="ctrl.updateSchema()">
                                Reload Schema
                        </md-button>
                    </md-list-item>
                </md-list>
            </md-card>

            <md-subheader class="md-no-sticky">
                Custom Vertex Labels
                <md-button class="md-primary md-icon-button inline-button" ng-click="ctrl.addCustomVertexLabel()">
                    <md-icon md-svg-icon="add"></md-icon>
                    <md-tooltip>Add custom vertex label</md-tooltip>
                </md-button>
            </md-subheader>
            <md-card>
                <md-card-content>

                    <p class="list-p" ng-if="ctrl.customVertexLabels.length == 0">No custom vertex labels</p>

                    <div ng-repeat="vertexLabel in ctrl.customVertexLabels track by $index">

                        <h3 class="list-h3 inline margin-right" ng-click="vertexLabel.labelEdit = true" ng-show="!vertexLabel.labelEdit">{{ vertexLabel.label }}</h3>
                        <md-input-container class="md-secondary no-errors no-margin list-h3" ng-show="vertexLabel.labelEdit">
                            <input type="text"
                                   ng-model="vertexLabel.label"
                                   aria-label="Edit label"
                                   ng-blur="ctrl.saveCustomVertexLabel(vertexLabel)">
                        </md-input-container>
                        <p class="list-p inline margin-right" ng-click="vertexLabel.vertexEdit = true" ng-show="!vertexLabel.vertexEdit">{{ vertexLabel.vertex }}</p>
                        <md-input-container class="md-secondary no-errors no-margin list-p" ng-show="vertexLabel.vertexEdit">
                            <input type="text"
                                   ng-model="vertexLabel.vertex"
                                   aria-label="Edit vertex"
                                   ng-blur="ctrl.saveCustomVertexLabel(vertexLabel)">
                        </md-input-container>

                        <md-button class="md-primary md-icon-button" ng-click="ctrl.deleteCustomVertexLabel(vertexLabel.id)">
                            <md-icon md-svg-icon="delete"></md-icon>
                            <md-tooltip>Delete label</md-tooltip>
                        </md-button>
                    </div>
                </md-card-content>
            </md-card>
        </div>
    </div>
</div>
